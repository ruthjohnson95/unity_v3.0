#!/usr/bin/env sh 

sim_yaml=$1 

# parse simulation parameters from input file 
SIM_NAME=$(cat $sim_yaml | grep "SIM NAME" | cut -d':' -f2 | tr -d " \t\n\r" )
H_SIM=$(cat $sim_yaml | grep "HERITABILITY" | cut -d':' -f2 | tr -d " \t\n\r" )
P_SIM=$(cat $sim_yaml | grep "P SIM" | cut -d':' -f2 | tr -d " \t\n\r" )
N=$(cat $sim_yaml | grep "SAMPLE SIZE" | cut -d':' -f2 | tr -d " \t\n\r" )
BLOCKS=$(cat $sim_yaml | grep "BLOCKS" | cut -d':' -f2 | tr -d " \t\n\r" )
SEED=$(cat $sim_yaml | grep "SEED" | cut -d':' -f2 | tr -d " \t\n\r" )
SIM_DIR=$(cat $sim_yaml | grep "SIM DIR" | cut -d':' -f2 | tr -d " \t\n\r" )
LD_HALF_DIR=$(cat $sim_yaml | grep "LD HALF DIR" | cut -d':' -f2 | tr -d " \t\n\r" )

echo $SIM_NAME
echo $H_SIM
echo $P_SIM
echo $N
echo $BLOCKS
echo $SEED
echo $SIM_DIR 
echo $LD_HALF_DIR

# make simulation dir 
OUTDIR=$SIM_DIR'/'$SIM_NAME 
mkdir -p $OUTDIR

# generate sample gwas 
python simulate.py --sim_name $SIM_NAME --h_sim $H_SIM --p_sim $P_SIM --N $N --blocks $BLOCKS --seed $SEED --ld_half_dir $LD_HALF_DIR --outdir $OUTDIR